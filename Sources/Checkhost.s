********************************************************************************
********************************************************************************
********************************************************************************
*                                                                              *
*          ##\ ##\##\#####\ ##### #####     #### /## /##/#####  /####          *
*          ## \## ## ##\ ## ##\   ##  ##   ##  ## ##  ## ## /##/##  ##         *
*          ##  ## ## ##  ## ##    ##  ##   ##     ##  ## ##  ## ##             *
*          ###### ## #####  ####  ##  ##   ##     ##  ## ##  ##  ####          *
*          ##  ## ## ##  ## ##    ##  ##   ##  ## ##  ## ##  ##     ##         *
*          ## /## ## ##  ## ##/   ##  ##   ##  ##\##  ## ##  ##\## \##         *
*          ##/ ##/##/##/ ##/##### #####     ##### \#### \## \## \####          *
*                                                                              *
********************************************************************************
**************************** © Scott Johnston 1990-93 **************************
********************************************************************************

********************************************************************************
************************* Check host for remote break **************************
********************************************************************************
;INPUT          none
;OUTPUT:	none
;CHANGES:       none

POUT		equ	1
BUSY		equ	0
CMD_Halt	equ	12

check_host	move.b	#1,ciabddrb		;Make BUSY output/POUT input
		btst	#POUT,ciabpra		;is POUT low?
		bne.s	.exit			;Nope, exit now

		clr.b	ciaaddrb		;Make data port input
		cmp.b	#CMD_Halt,ciaaprb	;Was it CMD_Halt?
		bne.s	.exit

		bclr	#BUSY,ciabpra		;Show acknowledged

.loop		btst	#POUT,ciabpra		;Has host got it?
		bne.s	.loop			;Nope, wait

		bset	#BUSY,ciabpra
		trap	#15				;Enter monitor

.exit		rts
